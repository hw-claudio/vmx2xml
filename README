REQUIREMENTS
------------

This script has been developed as a result of a sales opportunity for a VMWare -> KVM conversion.

The relevant requirements in the context of this specific script were:

* NFS servers serving OS images as .VMDK files, VM using vmware pvscsi virtual network device.
* Guest OSes including Windows 2008 .. 2022, RHEL 6.x to 8.x, SLES 12 to SLES 15 SP2, Ubuntu
* Virtual Firmware all legacy BIOS
* Conversion of VMDK to QCOW2 was needed but concern on the conversion times (automation and optimization required)

* Move from existing NFS datastore volumes to new NFS datastore volumes was necessary,
since the existing ones were already almost full at capacity, so the disks could not be converted "in place" in the same datastore.


----------------------------
WHAT THE vmx2xml SCRIPT DOES

The script primarily converts a VMX Virtual Machine definition into a libvirt XML domain file, that notably tries to match the existing
configuration, controller topology etc of the original VMX (with huge limitations, WIP etc).

The script also optionally can translate all references to VMDK disks in the VMX to references to QCOW2 disks,
optionally on a different datastore (IMPORTANT).

Here a datastore is basically just an NFS-reachable directory, so this functionality can be used also to convert VMs locally between
different local disks.

The script also can optionally trigger the conversion of the VMDK disks into QCOW2 disks bootable under KVM,
and this is done using the libguestfs tools and in most cases using virt-v2v.

There is a special option (-x) that can be used to use an alternative to virt-v2v, but it is experimental and especially not ready to handle Windows guests.

The script contains these different optional functionalities, so it can be relaunched once the QCOW2 disks have been already converted,
in order to update and fine tune the xml conversion itself, without the costly operation of moving or converting disk images.


------------

WHAT THE guestfs_adjust.py SCRIPT DOES

This is an experimental script that can be triggered instead of virt-v2v by using special option (-x) in the vmx2xml tool.
If in doubt, ignore it.

------------

WHAT THE datastore_migrate.sh SCRIPT DOES

This is a simple example script (that needs adaptation before use), which focuses on converting a whole datastore worth of VMs,
moving it to either a different datastore or another directory in the same datastore.

It is just a loop that calls vmx2xml for all .vmx VM definitions in a datastore,
with pre-chosen options to show a simple conversion from a DATASTORE1 to a DATASTORE-libvirt, including a separate extra
storage directory.

Normally it would be called as

# datastore_migrate.sh -c

to start the full conversion, including generating the .xml files, but also converting all the storage.

It can also be called as:

# datastore_migrate.sh -t

to translate the .vmx to .xml only,
also translating references to VMDK disks to QCOW2 disks, but without converting the storage itself.
